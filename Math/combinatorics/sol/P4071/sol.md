# P4071 [SDOI2016] 排列计数 

## 题意

求有多少种 $1$ 到 $n$ 的排列 $a$ ，
满足序列恰好有 $m$ 个位置 $i$ ，
使得 $a_i = i$

答案对 $10^9 + 7$ 取模

## 思路

把序列分为 $a_i = i$ 的和 $a_i \neq i$ 的，
用组合数选取。

设长度为 $k$ 的序列 $b_k$ ，
对于 $i \in [1,k]$ ，都有 $b_k [i] \neq i$

易得

$$
\begin{matrix}
  |b_0| = 1 \\
  |b_1| = 0 \\
  |b_2| = 1 
\end{matrix}
$$

对于 $b_{k+1}$ ，
可能由 $\left\{ x | x \in b_k , x = k+1\right \}$ 中，
最后一个元素与前面元素调换位置，
也可能是由顺序组成的序列，
最后一个元素和前面元素调换，
剩下 $k-1$ 个位置由 $b_{k-1}$
填充。

两种情况包含所有的情况，且没有重叠。

因此 $b_k = (k-1)(b_{k-1} + b_{k-2}), k \geq 3$

## 题解代码

[代码](main.cpp)
